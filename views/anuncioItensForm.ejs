<!DOCTYPE html>
<html lang="pt">
  <head>
    <title>Pereiro</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link
      href="https://cdn.jsdelivr.net/npm/daisyui@4.11.1/dist/full.min.css"
      rel="stylesheet"
      type="text/css"
    />
    <link rel="manifest" href="manifest.json" />
  </head>
  <body class="min-h-screen bg-gradient-to-b from-blue-100 to-blue-200">
    <div class="dark:bg-white navbar bg-base-100">
      <div class="flex-1">
        <img src="/logotipoER.png" alt="Logo" class="h-10 w-auto mr-2" />
        <a class="btn btn-ghost text-xl dark:text-black"
          >Pereiro - Plataforma de reutilização</a
        >
      </div>
      <div class="flex-none">
        <div class="dropdown dropdown-end">
          <button tabindex="0" class="btn btn-square btn-ghost dark:text-black">
            <svg
              xmlns="http://www.w3.org/2000/svg"
              fill="none"
              viewBox="0 0 24 24"
              class="inline-block h-5 w-5 stroke-current"
            >
              <path
                stroke-linecap="round"
                stroke-linejoin="round"
                stroke-width="2"
                d="M5 12h.01M12 12h.01M19 12h.01M6 12a1 1 0 11-2 0 1 1 0 012 0zm7 0a1 1 0 11-2 0 1 1 0 012 0zm7 0a1 1 0 11-2 0 1 1 0 012 0z"
              ></path>
            </svg>
          </button>
          <ul
            tabindex="0"
            class="dark:bg-white text-black dropdown-content menu menu-sm z-[1] mt-3 w-52 bg-base-100 p-2 shadow rounded-box"
          >
            <li><a href="/perfil">Perfil</a></li>
            <li><a href="/sair">Sair</a></li>
          </ul>
        </div>
      </div>
    </div>

    <!-- Hero Section -->
    <div class="container mx-auto px-4 py-16">
      <div class="max-w-4xl mx-auto text-center">
        <h1 class="text-4xl md:text-5xl font-bold text-gray-900 mb-6">
          Anuncio
        </h1>
      </div>
    </div>
    <section id="como-funciona" class="py-16 bg-white dark:text-black">
      <div class="container mx-auto px-4">
        <h2 class="text-3xl font-bold text-center text-dark mb-12">
          Publicacao Item
        </h2>
      </div>
      <div class="table flex-auto overflow-y-auto px-10">
        <% if (locals.error) { %>
        <div
          class="mb-4 bg-red-100 border border-red-400 text-red-700 px-4 py-3 rounded relative"
          role="alert"
        >
          <span class="block sm:inline"><%= error %></span>
        </div>
        <% } %>
        <form action="/anuncio" method="POST" enctype="multipart/form-data">
          <p class="text-1xl font-semibold mt-1 text-sm/6 text-gray-600">
            Tem a possibilidade de doar um item que ja não utilize, contribua
            para uma sociedade mais sustentável.
          </p>

          <div class="mt-10 grid grid-cols-1 gap-x-6 gap-y-8 sm:grid-cols-6">
            <div class="sm:col-span-6">
              <label
                for="nomeItem"
                class="block w-full font-medium text-gray-900"
                >Nome</label
              >
              <div class="mt-2 w-full">
                <div
                  class="w-full flex items-center rounded-md bg-white outline outline-1 -outline-offset-1 outline-gray-300 focus-within:outline focus-within:outline-2 focus-within:-outline-offset-2 focus-within:outline-indigo-600"
                >
                  <input
                    type="text"
                    name="nome"
                    id="nome"
                    class="block pl-3 w-full py-1.5 text-base text-gray-900 placeholder:text-gray-400 focus:outline focus:outline-0"
                    placeholder="Titularição do item"
                    required
                  />
                </div>
              </div>
            </div>

            <div class="col-span-full">
              <label
                for="descricao"
                class="block text-sm/6 font-medium text-gray-900"
                >Descrição</label
              >
              <div class="mt-2">
                <textarea
                  name="descricao"
                  id="descricao"
                  rows="3"
                  class="block w-full rounded-md bg-white px-3 py-1.5 text-base text-gray-900 outline outline-1 -outline-offset-1 outline-gray-300 placeholder:text-gray-400 focus:outline focus:outline-2 focus:-outline-offset-2 focus:outline-indigo-600 sm:text-sm/6"
                  required
                ></textarea>
              </div>
              <p class="mt-3 text-sm/6 text-gray-600">
                Descreva o seu item detalhadamente.
              </p>
            </div>

            <div class="col-span-full">
              <label
                for="fotosdoitem"
                class="block text-sm font-medium text-gray-900"
              >
                Fotos do item
              </label>
              <div
                class="mt-2 flex justify-center rounded-lg border border-dashed border-gray-900/25 px-6 py-10"
              >
                <div class="text-center">
                  <div class="mt-4 flex text-center text-sm text-gray-600">
                    <label
                      for="fotos"
                      class="relative cursor-pointer rounded-md bg-white font-medium text-indigo-600 focus-within:outline-none focus-within:ring-2 focus-within:ring-indigo-600 focus-within:ring-offset-2 hover:text-indigo-500"
                    >
                      <span>Carregar imagens</span>
                      <input
                        id="fotos"
                        name="fotos"
                        type="file"
                        class="sr-only"
                        accept="image/*"
                        multiple
                      />
                    </label>
                  </div>
                  <div
                    id="error-message"
                    class="text-red-500 text-sm mt-2"
                  ></div>
                  <div
                    id="preview"
                    class="mt-4 grid lg:grid-cols-8 gap-3"
                  ></div>
                  <p class="text-xs mt-2 text-gray-500">PNG, JPG até 5MB</p>
                </div>
              </div>

              <!-- Contêiner de pré-visualização -->
            </div>
          </div>
          <div class="mt-5 flex items-stretch">
            <div class="w-full px-2">
              <label
                for="peso"
                class="block text-sm/6 font-medium text-gray-900"
                >Peso (Kg)</label
              >
              <div class="mt-2">
                <input
                  type="number"
                  name="peso"
                  id="peso"
                  min="1"
                  max="998"
                  autocomplete="address-level2"
                  class="block w-full rounded-md bg-white px-3 py-1.5 text-base text-gray-900 outline outline-1 -outline-offset-1 outline-gray-300 placeholder:text-gray-400 focus:outline focus:outline-2 focus:-outline-offset-2 focus:outline-indigo-600 sm:text-sm/6"
                  placeholder="Indique o peso do seu item"
                  required
                />
              </div>
            </div>

            <div class="w-full px-2">
              <label
                for="localizacao"
                class="block text-sm/6 font-medium text-gray-900"
                >Localização</label
              >
              <div class="mt-2">
                <select
                  autocomplete="address-level2"
                  class="block w-full rounded-md bg-white px-3 py-2 text-base text-gray-900 outline outline-1 -outline-offset-1 outline-gray-300 placeholder:text-gray-400 focus:outline focus:outline-2 focus:-outline-offset-2 focus:outline-indigo-600 sm:text-sm/6"
                  name="localizacao"
                  id="localizacao"
                  required
                >
                  <option value="aveiro">Aveiro</option>
                  <option value="beja">Beja</option>
                  <option value="braga">Braga</option>
                  <option value="braganca">Bragança</option>
                  <option value="castelobranco">Castelo Branco</option>
                  <option value="coimbra">Coimbra</option>
                  <option value="evora">Évora</option>
                  <option value="faro">Faro</option>
                  <option value="guarda">Guarda</option>
                  <option value="leiria">Leiria</option>
                  <option value="lisboa">Lisboa</option>
                  <option value="portalegre">Portalegre</option>
                  <option value="porto">Porto</option>
                  <option value="santarem">Santarém</option>
                  <option value="setubal">Setúbal</option>
                  <option value="vianadocastelo">Viana do Castelo</option>
                  <option value="vilareal">Vila Real</option>
                  <option value="viseu">Viseu</option>
                  <option value="acores">Açores</option>
                  <option value="madeira">Madeira</option>
                </select>
              </div>
            </div>

            <div class="w-full px-2">
              <label
                for="categoria"
                class="block text-sm/6 font-medium text-gray-900"
                >Categoria</label
              >
              <div class="mt-2">
                <select
                  autocomplete="address-level2"
                  class="block w-full rounded-md bg-white px-3 py-2 text-base text-gray-900 outline outline-1 -outline-offset-1 outline-gray-300 placeholder:text-gray-400 focus:outline focus:outline-2 focus:-outline-offset-2 focus:outline-indigo-600 sm:text-sm/6"
                  name="categoria"
                  id="categoria"
                  required
                >
                  <option value="eletrodomesticos">Eletrodomésticos</option>
                  <option value="roupas">Roupa</option>
                  <option value="moveis">Móveis e Decoração</option>
                  <option value="esportes-e-lazer">Esportes e Lazer</option>
                  <option value="ferramentas">Ferramentas</option>
                  <option value="livros">Livros</option>
                  <option value="materialeducativo">Material educativo</option>
                  <option value="brinquedos">Brinquedos</option>
                  <option value="jogos">Jogos</option>
                  <option value="saudebeleza">Saúde e Beleza</option>
                  <option value="automovel">Automovel</option>
                  <option value="animais">Animais</option>
                  <option value="tecnologia">Tecnologia</option>
                  <option value="materiaisescritorio">
                    Materiais de escritorios
                  </option>
                  <option value="jardinagem">Jardinagem</option>
                  <option value="instrumentosmusicais">
                    Instrumentos Musicais
                  </option>
                  <option value="viagensacessorios">
                    Viagens e Acessórios
                  </option>
                  <option value="modainfantil">Moda Infantil</option>
                  <option value="produtoslimpeza">Produtos de Limpeza</option>
                  <option value="seguranca">Segurança</option>
                  <option value="arte">Arte</option>
                </select>
              </div>
            </div>
          </div>
          <div class="mt-5 gap-x-10 grid grid-cols-2 justify-center">
            <button
              class="bg-blue-500 hover:bg-blue-700 text-white font-bold rounded focus:outline-none focus:shadow-outline w-full h-10"
              type="submit"
            >
              Publicar
            </button>
            <button
              type="button"
              class="bg-zinc-400 hover:bg-zinc-600 text-white font-bold rounded focus:outline-none focus:shadow-outline w-full h-10"
            >
              <a href="/"> Cancelar </a>
            </button>
          </div>
        </form>
      </div>
    </section>
    <script>
      document
        .getElementById("fotos")
        .addEventListener("change", function (event) {
          const files = event.target.files;
          const previewContainer = document.getElementById("preview");
          const errorMessage = document.getElementById("error-message");
          previewContainer.innerHTML = ""; // Limpa a pré-visualização anterior
          errorMessage.textContent = ""; // Limpa mensagens de erro

          const maxFiles = 10;
          const minFiles = 5;
          const maxSizeMB = 5;

          // Validação de número de arquivos
          if (files.length < minFiles || files.length > maxFiles) {
            errorMessage.textContent = `Por favor, selecione entre ${minFiles} e ${maxFiles} imagens.`;
            return;
          }

          Array.from(files).forEach((file) => {
            if (file.size > maxSizeMB * 1024 * 1024) {
              errorMessage.textContent = `As imagens devem ter no máximo ${maxSizeMB} MB.`;
              return;
            }

            if (file.type.startsWith("image/")) {
              const reader = new FileReader();

              reader.onload = (e) => {
                // Cria o container para cada imagem
                const imgWrapper = document.createElement("div");
                imgWrapper.className =
                  "relative w-32 h-32 border border-gray-300 rounded-md overflow-hidden shadow-sm";

                const img = document.createElement("img");
                img.src = e.target.result;
                img.alt = "Preview";
                img.className = "object-cover w-full h-full";

                // Botão de remoção
                const removeButton = document.createElement("button");
                removeButton.className =
                  "absolute top-2 right-2 bg-red-600 text-white rounded-full p-1 hover:bg-red-700";
                removeButton.textContent = "×";
                removeButton.onclick = () => imgWrapper.remove();

                imgWrapper.appendChild(img);
                imgWrapper.appendChild(removeButton);
                previewContainer.appendChild(imgWrapper);
              };

              reader.readAsDataURL(file);
            }
          });
        });
    </script>

    <footer class="bg-white py-8">
      <div class="container mx-auto px-4">
        <div class="text-center text-dark">
          <p>&copy; Pereiro - Plataforma de reutilização</p>
          <p>Todos os direitos reservados.</p>
        </div>
      </div>
    </footer>
  </body>
</html>
